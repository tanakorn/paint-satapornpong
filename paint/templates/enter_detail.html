<html>
<head>
  <script type="text/javascript">
    function changeSize(size_id, size_value) {
      document.getElementById("size_id").value = size_id;
      document.getElementById("size_label").innerHTML = size_value;
    }

    function changeBase(base_id, base_value) {
      document.getElementById("base_id").value = base_id;
      document.getElementById("base_label").innerHTML = base_value;
    }

    function validate(evt) {
      var theEvent = evt || window.event;
      var key = theEvent.keyCode || theEvent.which;
      key = String.fromCharCode(key);
      var regex = /[0-9]/;
      if(!regex.test(key)) {
        theEvent.returnValue = false;
        if(theEvent.preventDefault) theEvent.preventDefault();
      }
    }

    function calculate() {
      unit = document.getElementById("unit").value;
      price = document.getElementById("price").value;
      amount_price = unit * price;
      document.getElementById("amount_price").innerHTML = amount_price;
    }

    function validateForm() {
      size_id = document.getElementById("size_id").value;
      if(size_id == null || size_id == "") {
        alert("ยังไม่ได้เลือกขนาดสี");
        return false;
      }
      base_id = document.getElementById("base_id").value;
      if(base_id == null || base_id == "") {
        alert("ยังไม่ได้เลือกสีเบส");
        return false;
      }
      code = document.getElementById("code").value;
      if(code == null || code == "") {
        alert("ยังไม่ได้ใส่เบอร์สี");
        return false;
      }
    }
  </script>
</head>
<body>
  <form action="/sell/record/" method="post" onSubmit="return validateForm()">
    {% csrf_token %}
    <input type="hidden" id="function_id" name="function_id" value="{{ function_id }}" />
    <input type="hidden" id="size_id" name="size_id" value="" />
    <input type="hidden" id="base_id" name="base_id" value="" />
    <table border="1">
      <tr>
        <td>ขนาด</td>
        <td>
        {% for size in size_list %}
          <input type="button" value="{{ size.value }}" onClick="changeSize({{ size.id }}, '{{ size.value }}')" />
        {% endfor %}
        </td>
        <td> <span id="size_label"> </span> </td>
      </tr>
      <tr>
        <td>Base</td>
        <td>
        {% for base in base_list %}
          <input type="button" value="{{ base.name }}" onClick="changeBase({{ base.id }}, '{{ base.name }}')" />
        {% endfor %}
        </td>
        <td> <span id="base_label"> </span> </td>
      </tr>
      <tr>
        <td> เบอร์สี </td>
        <td colspan="2"> <input type="text" id="code" name="code" /> </td>
      </tr>
      <tr>
        <td> จำนวน </td>
        <td> <input type="text" id="unit" name="unit" onKeyPress="validate(event)" onChange="calculate()" value="1" /> </td>
        <td rowspan="2"> ราคารวม = <span id="amount_price">0</span> </td>
      </tr>
      <tr>
        <td> ราคา </td>
        <td> <input type="text" id="price" name="price" onKeyPress="validate(event)" onChange="calculate()" value="0"/> </td>
      </tr>
      <tr>
        <td> ชื่อลูกค้า </td>
        <td colspan="2"> <input type="text" id="customer" name="customer" /> </td>
      </tr>
      <tr>
        <td> หมายเหตุ </td>
        <td colspan="2"> <textarea id="note" name="note" cols="40" rows="4"></textarea> </td>
      </tr>
    </table>
    <input type="submit" value="บันทึก" />
  </form>
</body>
</html>
